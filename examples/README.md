# 埋点 SDK 示例程序

本目录包含多个示例程序，演示如何使用埋点 SDK 的各种功能。

## 📁 示例文件列表

### 1. `quick-test.ts` - 快速测试程序 ⚡
最简单的测试程序，用于快速验证 SDK 功能：
- 9 个基本测试步骤
- 清晰的控制台输出
- 适合快速验证和演示

**适合**: 第一次使用、快速验证功能

**运行**: `yarn example:quick`

### 2. `basic-usage.ts` - 基础使用示例
最简单的使用示例，展示 SDK 的基本功能：
- SDK 初始化
- 用户注册、登录、登出
- 订阅事件
- 页面访问追踪
- 点击事件追踪
- 自定义事件
- 批量上报

**适合**: 快速了解 SDK 的核心功能

**运行**: `yarn example:basic`

### 3. `nuxt-plugin.ts` - Nuxt 4 插件示例
完整的 Nuxt 4 集成示例：
- Nuxt 插件配置
- 路由变化监听
- 错误事件追踪
- 全局方法注册
- TypeScript 类型声明

**适合**: Nuxt 项目集成参考

### 4. `comprehensive-test.ts` - 综合测试程序 🧪
完整的自动化测试程序，包含 13 个测试场景：
- ✅ SDK 初始化测试
- ✅ 用户注册流程测试
- ✅ 用户登录和登出测试
- ✅ 订阅功能测试
- ✅ 页面访问追踪测试
- ✅ 点击事件追踪测试
- ✅ 自定义事件测试
- ✅ 批量上报机制测试
- ✅ 即时上报测试
- ✅ 手动刷新队列测试
- ✅ 复杂场景 - 用户完整旅程测试
- ✅ 性能测试 (100 个事件)
- ✅ 错误处理测试

**适合**: 开发测试、功能验证、性能评估

**运行**: `yarn example:test`

## 🚀 快速开始

### 推荐学习顺序

1. **第一次使用**
```bash
yarn build              # 构建 SDK
yarn example:quick      # 运行快速测试
```

2. **学习完整功能**
```bash
yarn example:basic      # 查看基础示例
```

3. **全面测试**
```bash
yarn example:test       # 运行综合测试
```

## 🚀 运行示例程序

### 前置准备

1. **安装依赖**
```bash
yarn install
```

2. **构建 SDK**
```bash
yarn build
```

### 运行方式 1: 使用 yarn 脚本 (推荐) ⭐

```bash
# 快速测试
yarn example:quick

# 基础示例
yarn example:basic

# 综合测试
yarn example:test
```

### 运行方式 2: 使用 tsx 直接运行

```bash
# 运行快速测试
npx tsx examples/quick-test.ts

# 运行基础示例
npx tsx examples/basic-usage.ts

# 运行综合测试
npx tsx examples/comprehensive-test.ts
```

### 运行方式 3: 使用 ts-node

```bash
# 安装 ts-node (如果还没有)
yarn add -D ts-node

# 运行示例
npx ts-node examples/quick-test.ts
```

## 📊 综合测试程序输出示例

运行 `comprehensive-test.ts` 后，你将看到详细的测试输出：

```
╔═══════════════════════════════════════════════════════════╗
║                                                           ║
║         🧪 埋点 SDK 综合测试程序                          ║
║                                                           ║
╚═══════════════════════════════════════════════════════════╝

============================================================
🧪 测试 1: SDK 初始化
============================================================
✅ SDK 初始化成功
ℹ️  配置: {
  "apiEndpoint": "https://api-test.holink.com",
  "siteDomain": "test.holink.com",
  "debug": true,
  ...
}

============================================================
🧪 测试 2: 用户注册流程
============================================================
✅ 设置用户 ID: test_user_1701234567890
✅ 注册事件已追踪

... (更多测试输出)

╔═══════════════════════════════════════════════════════════╗
║                                                           ║
║         ✅ 所有测试完成                                    ║
║                                                           ║
╚═══════════════════════════════════════════════════════════╝
```

## 🔧 自定义测试配置

你可以修改 `comprehensive-test.ts` 中的 `TEST_CONFIG` 来自定义测试：

```typescript
const TEST_CONFIG = {
  apiEndpoint: 'https://your-api.com',  // 你的 API 端点
  siteDomain: 'your-site.com',          // 你的站点域名
  debug: true,                          // 启用调试日志
  batchSize: 5,                         // 批量上报阈值
  batchInterval: 3000,                  // 自动上报间隔 (ms)
  autoPageView: false,                  // 自动页面访问追踪
  autoClick: false,                     // 自动点击事件追踪
  enableStorage: true,                  // 启用本地存储
}
```

## 📖 使用建议

### 学习路径

1. **初学者**: 先看 `basic-usage.ts`，了解基本概念
2. **进阶用户**: 查看 `comprehensive-test.ts`，学习高级用法
3. **Nuxt 开发者**: 参考 `nuxt-plugin.ts` 进行集成

### 测试建议

- 在开发环境中，设置 `debug: true` 查看详细日志
- 使用 `comprehensive-test.ts` 验证 SDK 功能
- 根据实际需求调整批量上报参数

### 集成到项目

1. 复制相关示例代码到你的项目
2. 修改 API 端点和配置
3. 根据业务需求调整事件追踪逻辑
4. 添加必要的错误处理

## 🧪 测试场景说明

### 1. 基础功能测试
- **初始化**: 测试 SDK 正确初始化
- **用户管理**: 测试用户 ID 设置和清除
- **事件追踪**: 测试各类事件的追踪功能

### 2. 高级功能测试
- **批量上报**: 验证事件批量发送机制
- **即时上报**: 测试重要事件的即时发送
- **离线重试**: 验证本地存储和重试机制

### 3. 性能测试
- **大量事件**: 生成 100 个事件测试性能
- **响应时间**: 测量事件处理平均耗时
- **内存使用**: 观察内存使用情况

### 4. 边界测试
- **空数据**: 测试空事件数据的处理
- **超长字符串**: 测试大数据量的处理
- **特殊字符**: 测试特殊字符和 emoji
- **嵌套对象**: 测试复杂数据结构

## 🐛 常见问题

### Q: 运行时提示找不到模块？
**A**: 确保先运行 `yarn build` 构建 SDK

### Q: 看不到调试日志？
**A**: 检查配置中的 `debug` 选项是否设置为 `true`

### Q: 事件没有立即发送？
**A**: 这是正常的，SDK 使用批量上报机制。可以调用 `tracker.flush()` 立即发送，或使用 `tracker.sendImmediately()` 发送重要事件

### Q: 如何模拟真实的 API 请求？
**A**: 修改 `TEST_CONFIG.apiEndpoint` 为你的测试 API 地址

## 📚 相关文档

- [主文档](../README.md) - SDK 完整文档
- [设计文档](../docs/2-1-埋点SDK设计.md) - 架构设计说明
- [安装指南](../SETUP.md) - 项目安装配置

## 💡 贡献示例

欢迎提交更多使用示例！

1. 在 `examples/` 目录下创建新的示例文件
2. 添加清晰的注释和说明
3. 更新本 README 文档
4. 提交 Pull Request

## 📝 许可证

MIT License - 详见 [LICENSE](../LICENSE)

