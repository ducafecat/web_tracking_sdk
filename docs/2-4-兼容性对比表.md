# ğŸ“Š åŸ‹ç‚¹ SDK ä¸ Nuxt 4 é›†æˆå…¼å®¹æ€§å¯¹æ¯”è¡¨

## å¿«é€Ÿå‚è€ƒæŒ‡å—

æœ¬æ–‡æ¡£æä¾› **æ–‡æ¡£ 2-1ï¼ˆåŸ‹ç‚¹SDKè®¾è®¡ï¼‰** ä¸ **æ–‡æ¡£ 2-2ï¼ˆNuxt 4 é›†æˆï¼‰** ä¹‹é—´çš„è¯¦ç»†å¯¹æ¯”ï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿäº†è§£ä¸¤ä¸ªæ–‡æ¡£çš„å…¼å®¹æ€§ã€‚

---

## ğŸ“‹ æ–¹æ³•åå¯¹ç…§è¡¨

| æ–‡æ¡£ 2-2 (Nuxt 4) ä½¿ç”¨çš„æ–¹æ³• | æ–‡æ¡£ 2-1 (SDK) æä¾›çš„æ–¹æ³• | å…¼å®¹çŠ¶æ€ | è¯´æ˜ |
|--------------------------|----------------------|---------|------|
| `trackPageView(path, title)` | `trackPageView(path, title)` | âœ… å®Œå…¨å…¼å®¹ | æ–°å¢çš„åˆ«åæ–¹æ³• |
| `trackPageView(path, title)` | `trackVisit(path, title)` | âœ… å®Œå…¨å…¼å®¹ | trackPageView æ˜¯ trackVisit çš„åˆ«å |
| `trackClick(elementId, text, linkId)` | `trackClick(data)` | âœ… å®Œå…¨å…¼å®¹ | æ–°å¢æ–¹æ³•ï¼Œæ”¯æŒå¤šç§å‚æ•°æ ¼å¼ |
| `trackRegister(data)` | `trackRegister(data)` | âœ… å®Œå…¨å…¼å®¹ | æ— å˜åŒ– |
| `trackSubscribe(plan, duration, amount)` | `trackSubscribe(data)` | âœ… å®Œå…¨å…¼å®¹ | æ— å˜åŒ– |
| `trackLogin(userId, method)` | `trackLogin(data)` | âœ… å®Œå…¨å…¼å®¹ | æ— å˜åŒ– |
| `trackLogout()` | `trackLogout()` | âœ… å®Œå…¨å…¼å®¹ | æ— å˜åŒ– |
| `trackCustom(name, data)` | `trackCustom(name, data)` | âœ… å®Œå…¨å…¼å®¹ | æ— å˜åŒ– |
| `setUserId(userId)` | `setUserId(userId)` | âœ… å®Œå…¨å…¼å®¹ | æ— å˜åŒ– |
| `clearUserId()` | `clearUserId()` | âœ… å®Œå…¨å…¼å®¹ | æ— å˜åŒ– |
| `flush()` | `flush()` | âœ… å®Œå…¨å…¼å®¹ | æ— å˜åŒ– |

---

## âš™ï¸ é…ç½®é€‰é¡¹å¯¹ç…§è¡¨

| é…ç½®é¡¹ | æ–‡æ¡£ 2-2 (Nuxt 4) | æ–‡æ¡£ 2-1 (SDK) | å…¼å®¹çŠ¶æ€ | è¯´æ˜ |
|-------|-----------------|---------------|---------|------|
| `apiEndpoint` | âœ… ä½¿ç”¨ | âœ… æ”¯æŒ | âœ… å®Œå…¨å…¼å®¹ | API ç«¯ç‚¹ |
| `debug` | âœ… ä½¿ç”¨ | âœ… æ”¯æŒ | âœ… å®Œå…¨å…¼å®¹ | è°ƒè¯•æ¨¡å¼ |
| `batchSize` | âœ… ä½¿ç”¨ | âœ… æ”¯æŒ | âœ… å®Œå…¨å…¼å®¹ | æ‰¹é‡ä¸ŠæŠ¥é˜ˆå€¼ |
| `batchInterval` | âœ… ä½¿ç”¨ | âœ… æ”¯æŒ | âœ… å®Œå…¨å…¼å®¹ | æ‰¹é‡ä¸ŠæŠ¥é—´éš” |
| `autoPageView` | âœ… ä½¿ç”¨ | âœ… æ”¯æŒ | âœ… å®Œå…¨å…¼å®¹ | è‡ªåŠ¨é¡µé¢è¿½è¸ª |
| `autoClick` | âœ… ä½¿ç”¨ | âœ… æ”¯æŒ | âœ… å®Œå…¨å…¼å®¹ | è‡ªåŠ¨ç‚¹å‡»è¿½è¸ªï¼ˆæ–°å¢ï¼‰ |
| `enableStorage` | âœ… ä½¿ç”¨ | âœ… æ”¯æŒ | âœ… å®Œå…¨å…¼å®¹ | æœ¬åœ°å­˜å‚¨ |
| `storagePrefix` | âœ… ä½¿ç”¨ | âœ… æ”¯æŒ | âœ… å®Œå…¨å…¼å®¹ | å­˜å‚¨å‰ç¼€ |
| `timeout` | âšª æœªä½¿ç”¨ | âœ… æ”¯æŒ | âœ… å®Œå…¨å…¼å®¹ | è¯·æ±‚è¶…æ—¶ |
| `maxRetries` | âšª æœªä½¿ç”¨ | âœ… æ”¯æŒ | âœ… å®Œå…¨å…¼å®¹ | æœ€å¤§é‡è¯•æ¬¡æ•° |

---

## ğŸ¯ äº‹ä»¶ç±»å‹å¯¹ç…§è¡¨

| äº‹ä»¶ç±»å‹ | æ–‡æ¡£ 2-2 (Nuxt 4) è§¦å‘æ–¹å¼ | æ–‡æ¡£ 2-1 (SDK) æ”¯æŒ | å…¼å®¹çŠ¶æ€ |
|---------|------------------------|-------------------|---------|
| æ³¨å†Œäº‹ä»¶ (`register`) | `trackRegister()` | âœ… | âœ… å®Œå…¨å…¼å®¹ |
| è®¢é˜…äº‹ä»¶ (`subscribe`) | `trackSubscribe()` | âœ… | âœ… å®Œå…¨å…¼å®¹ |
| ç™»å½•äº‹ä»¶ (`login`) | `trackLogin()` | âœ… | âœ… å®Œå…¨å…¼å®¹ |
| ç™»å‡ºäº‹ä»¶ (`logout`) | `trackLogout()` | âœ… | âœ… å®Œå…¨å…¼å®¹ |
| é¡µé¢è®¿é—® (`visit`) | `trackPageView()` | âœ… | âœ… å®Œå…¨å…¼å®¹ |
| ç‚¹å‡»äº‹ä»¶ (`click`) | `trackClick()` | âœ… | âœ… å®Œå…¨å…¼å®¹ï¼ˆæ–°å¢ï¼‰ |
| è‡ªå®šä¹‰äº‹ä»¶ | `trackCustom()` | âœ… | âœ… å®Œå…¨å…¼å®¹ |

---

## ğŸ”§ ä½¿ç”¨æ–¹å¼å¯¹æ¯”

### 1. åˆå§‹åŒ– SDK

#### æ–‡æ¡£ 2-2 (Nuxt 4)
```typescript
// plugins/tracking.client.ts
const tracker = new TrackingSDK({
  apiEndpoint: config.public.trackingApiEndpoint as string,
  debug: config.public.trackingDebug === 'true',
  batchSize: 10,
  batchInterval: 5000,
  autoPageView: true,
  autoClick: false,  // âš ï¸ ä¹‹å‰ä¸æ”¯æŒï¼Œç°åœ¨æ”¯æŒ
  enableStorage: true,
  storagePrefix: 'holink_track_',
});
```

#### æ–‡æ¡£ 2-1 (SDK)
```typescript
// main.ts
const tracker = new TrackingSDK({
  apiEndpoint: 'https://your-api.com',
  debug: process.env.NODE_ENV === 'development',
  batchSize: 10,
  batchInterval: 5000,
  autoPageView: true,
  autoClick: false,  // âœ… æ–°å¢æ”¯æŒ
  enableStorage: true,
});
```

**å…¼å®¹æ€§**ï¼šâœ… å®Œå…¨å…¼å®¹

---

### 2. é¡µé¢è®¿é—®è¿½è¸ª

#### æ–‡æ¡£ 2-2 (Nuxt 4)
```typescript
const tracking = useTracking();
tracking.trackPageView(path, title);  // âš ï¸ ä¹‹å‰ä¸æ”¯æŒï¼Œç°åœ¨æ”¯æŒ
```

#### æ–‡æ¡£ 2-1 (SDK)
```typescript
// æ–¹å¼1ï¼šåŸæœ‰æ–¹æ³•
tracker.trackVisit(path, title);

// æ–¹å¼2ï¼šæ–°å¢åˆ«åæ–¹æ³•
tracker.trackPageView(path, title);  // âœ… æ–°å¢æ”¯æŒ
```

**å…¼å®¹æ€§**ï¼šâœ… å®Œå…¨å…¼å®¹ï¼ˆæ–°å¢ `trackPageView` åˆ«åï¼‰

---

### 3. ç‚¹å‡»äº‹ä»¶è¿½è¸ª

#### æ–‡æ¡£ 2-2 (Nuxt 4)
```typescript
const tracking = useTracking();

// âš ï¸ ä¹‹å‰ä¸æ”¯æŒï¼Œç°åœ¨æ”¯æŒ
tracking.trackClick('button_id', 'æŒ‰é’®æ–‡æœ¬', 'page_name');
```

#### æ–‡æ¡£ 2-1 (SDK)
```typescript
// ç®€å•ç”¨æ³•
tracker.trackClick('button_id');  // âœ… æ–°å¢æ”¯æŒ

// å®Œæ•´ç”¨æ³•
tracker.trackClick({
  elementId: 'button_id',
  elementText: 'æŒ‰é’®æ–‡æœ¬',
  linkId: 'page_name',
});  // âœ… æ–°å¢æ”¯æŒ
```

**å…¼å®¹æ€§**ï¼šâœ… å®Œå…¨å…¼å®¹ï¼ˆæ–°å¢ `trackClick` æ–¹æ³•ï¼‰

---

### 4. ç”¨æˆ·æ³¨å†Œè¿½è¸ª

#### æ–‡æ¡£ 2-2 (Nuxt 4)
```typescript
tracking.trackRegister({
  uid: userId,
  source: 'email',
  linkId: 'register_form',
  eventData: {
    referrer: document.referrer,
  },
});
```

#### æ–‡æ¡£ 2-1 (SDK)
```typescript
tracker.trackRegister({
  uid: userId,
  source: 'email',
  linkId: 'register_form',
  eventData: {
    utm_source: 'google',
  },
});
```

**å…¼å®¹æ€§**ï¼šâœ… å®Œå…¨å…¼å®¹

---

### 5. ç”¨æˆ·è®¢é˜…è¿½è¸ª

#### æ–‡æ¡£ 2-2 (Nuxt 4)
```typescript
tracking.trackSubscribe(plan.id, plan.duration, plan.price);
```

#### æ–‡æ¡£ 2-1 (SDK)
```typescript
tracker.trackSubscribe({
  plan: plan.id,
  duration: plan.duration,
  amount: plan.price,
  linkId: 'subscribe_page',
});
```

**å…¼å®¹æ€§**ï¼šâœ… å®Œå…¨å…¼å®¹ï¼ˆå‚æ•°æ ¼å¼ç•¥æœ‰ä¸åŒï¼Œä½†åŠŸèƒ½ç­‰ä»·ï¼‰

---

## ğŸ“¦ ç±»å‹å®šä¹‰å¯¹ç…§

### æ–°å¢ç±»å‹

| ç±»å‹å | çŠ¶æ€ | è¯´æ˜ |
|-------|------|------|
| `ClickEvent` | âœ… æ–°å¢ | ç‚¹å‡»äº‹ä»¶æ¥å£ |
| `EventType.CLICK` | âœ… æ–°å¢ | ç‚¹å‡»äº‹ä»¶æšä¸¾å€¼ |

### ä¿®æ”¹çš„ç±»å‹

| ç±»å‹å | ä¿®æ”¹å†…å®¹ | è¯´æ˜ |
|-------|---------|------|
| `TrackingConfig` | æ·»åŠ  `autoClick?: boolean` | æ–°å¢é…ç½®é¡¹ |

---

## ğŸš¨ å‡çº§æ³¨æ„äº‹é¡¹

### å¯¹äºå·²æœ‰é¡¹ç›®

å¦‚æœä½ å·²ç»åŸºäº**æ—§ç‰ˆæ–‡æ¡£ 2-1** å®ç°äº† SDKï¼Œéœ€è¦ï¼š

1. âœ… **æ·»åŠ æ–°çš„ç±»å‹å®šä¹‰**
   - åœ¨ `types.ts` ä¸­æ·»åŠ  `ClickEvent` æ¥å£
   - åœ¨ `EventType` æšä¸¾ä¸­æ·»åŠ  `CLICK` å€¼

2. âœ… **æ›´æ–° `TrackingConfig` æ¥å£**
   - æ·»åŠ  `autoClick?: boolean` é…ç½®é¡¹

3. âœ… **åœ¨ `TrackingSDK` ç±»ä¸­æ·»åŠ æ–°æ–¹æ³•**
   - æ·»åŠ  `trackPageView()` æ–¹æ³•
   - æ·»åŠ  `trackClick()` æ–¹æ³•
   - æ·»åŠ  `setupClickListener()` ç§æœ‰æ–¹æ³•

4. âœ… **æ›´æ–°æ„é€ å‡½æ•°å’Œåˆå§‹åŒ–æ–¹æ³•**
   - åœ¨æ„é€ å‡½æ•°ä¸­å¤„ç† `autoClick` é…ç½®
   - åœ¨ `init()` æ–¹æ³•ä¸­è°ƒç”¨ `setupClickListener()`

### å¯¹äºæ–°é¡¹ç›®

ç›´æ¥æŒ‰ç…§**æ›´æ–°åçš„æ–‡æ¡£ 2-1** å®ç°å³å¯ï¼Œæ‰€æœ‰åŠŸèƒ½å·²å†…ç½®ã€‚

---

## âœ… éªŒè¯æ¸…å•

ä½¿ç”¨ä»¥ä¸‹æ¸…å•éªŒè¯ä½ çš„å®ç°æ˜¯å¦å®Œå…¨å…¼å®¹ï¼š

- [ ] SDK æ”¯æŒ `trackPageView()` æ–¹æ³•
- [ ] SDK æ”¯æŒ `trackClick()` æ–¹æ³•ï¼ˆå­—ç¬¦ä¸²å‚æ•°ï¼‰
- [ ] SDK æ”¯æŒ `trackClick()` æ–¹æ³•ï¼ˆå¯¹è±¡å‚æ•°ï¼‰
- [ ] SDK é…ç½®æ”¯æŒ `autoClick` é€‰é¡¹
- [ ] `autoClick: true` æ—¶ï¼Œç‚¹å‡»å¸¦ `data-track` å±æ€§çš„å…ƒç´ ä¼šè‡ªåŠ¨ä¸ŠæŠ¥
- [ ] `trackPageView()` å’Œ `trackVisit()` åŠŸèƒ½å®Œå…¨ç›¸åŒ
- [ ] æ‰€æœ‰åŸæœ‰æ–¹æ³•ï¼ˆ`trackRegister`ã€`trackSubscribe` ç­‰ï¼‰ä»ç„¶æ­£å¸¸å·¥ä½œ
- [ ] ç±»å‹å®šä¹‰å®Œæ•´ï¼ŒTypeScript ç¼–è¯‘æ— é”™è¯¯
- [ ] ä¸åç«¯ API çš„æ•°æ®æ ¼å¼åŒ¹é…ï¼ˆå­—æ®µåä¸º `x_uid`ã€`x_link_id` ç­‰ï¼‰

---

## ğŸ“ æœ€ä½³å®è·µå»ºè®®

### 1. é¡µé¢è®¿é—®è¿½è¸ª

**æ¨è**ï¼šåœ¨ Nuxt 4 é¡¹ç›®ä¸­ä½¿ç”¨ `trackPageView()`
```typescript
// âœ… æ¨èï¼ˆè¯­ä¹‰æ›´æ¸…æ™°ï¼‰
tracking.trackPageView('/home', 'é¦–é¡µ');

// âœ… ä¹Ÿå¯ä»¥ï¼ˆåŠŸèƒ½ç›¸åŒï¼‰
tracking.trackVisit('/home', 'é¦–é¡µ');
```

### 2. ç‚¹å‡»äº‹ä»¶è¿½è¸ª

**æ¨è**ï¼šæ‰‹åŠ¨è°ƒç”¨ `trackClick()`ï¼Œè€Œä¸æ˜¯å¯ç”¨ `autoClick`
```typescript
// âœ… æ¨èï¼ˆæ›´ç²¾ç¡®æ§åˆ¶ï¼‰
<button @click="() => tracking.trackClick('submit_button', 'æäº¤')">
  æäº¤
</button>

// âš ï¸ ä¸æ¨èï¼ˆä¼šäº§ç”Ÿå¤§é‡äº‹ä»¶ï¼‰
<button data-track>æäº¤</button>
```

### 3. é…ç½®é€‰é¡¹

**æ¨èé…ç½®**ï¼š
```typescript
const tracker = new TrackingSDK({
  apiEndpoint: 'https://your-api.com',
  debug: process.env.NODE_ENV === 'development',
  batchSize: 10,
  batchInterval: 5000,
  autoPageView: true,   // âœ… å¯ç”¨ï¼ˆè‡ªåŠ¨è¿½è¸ªé¡µé¢è®¿é—®ï¼‰
  autoClick: false,      // âœ… ç¦ç”¨ï¼ˆé¿å…è¿‡å¤šäº‹ä»¶ï¼‰
  enableStorage: true,   // âœ… å¯ç”¨ï¼ˆç¦»çº¿æ”¯æŒï¼‰
});
```

---

## ğŸ“ é—®é¢˜åé¦ˆ

å¦‚æœå‘ç°ä»»ä½•å…¼å®¹æ€§é—®é¢˜ï¼Œè¯·ï¼š

1. æ£€æŸ¥ SDK ç‰ˆæœ¬æ˜¯å¦ä¸º **1.1.0** æˆ–æ›´é«˜
2. å¯¹ç…§æœ¬æ–‡æ¡£çš„æ¸…å•é€é¡¹æ£€æŸ¥
3. æŸ¥çœ‹ `docs/2-3-SDKæ›´æ–°æ—¥å¿—.md` äº†è§£è¯¦ç»†æ›´æ–°å†…å®¹

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼š1.0
**æœ€åæ›´æ–°**ï¼š2025-11-27
**å…¼å®¹æ€§çŠ¶æ€**ï¼šâœ… å®Œå…¨å…¼å®¹

